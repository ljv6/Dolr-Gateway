<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆØ§Ø¨Ø© ØªÙˆØ±ÙŠØ¯ Ø¯ÙˆÙ„Ø± | Dolr Pay</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #3b82f6; --bg: #020617; --card: #0f172a; --border: #1e293b; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        body { background-color: var(--bg); color: white; display: flex; justify-content: center; padding: 20px; }
        .wrapper { width: 100%; max-width: 450px; }
        header { text-align: center; margin-bottom: 2rem; }
        .logo { width: 70px; border-radius: 15px; margin-bottom: 10px; border: 1px solid var(--primary); }
        .products-grid { display: grid; gap: 10px; margin-bottom: 1.5rem; }
        .product-item { background: var(--card); border: 1px solid var(--border); padding: 15px; border-radius: 12px; cursor: pointer; display: flex; justify-content: space-between; transition: 0.3s; }
        .product-item.selected { border-color: var(--primary); background: rgba(59, 130, 246, 0.1); }
        .payment-form { background: var(--card); padding: 20px; border-radius: 15px; border: 1px solid var(--border); display: none; }
        .form-group { margin-bottom: 12px; text-align: right; }
        label { display: block; font-size: 0.8rem; color: #94a3b8; margin-bottom: 5px; }
        input { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border); background: #1e293b; color: white; text-align: right; }
        .btn-submit { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 10px; font-weight: 800; cursor: pointer; margin-top: 10px; }
        #loader { display: none; color: var(--primary); font-size: 0.9rem; margin-top: 10px; text-align: center; }
    </style>
</head>
<body>

<div class="wrapper">
    <header>
        <img src="IMG_7454.jpeg" alt="Dolr" class="logo">
        <h2>Ø¨ÙˆØ§Ø¨Ø© ØªÙˆØ±ÙŠØ¯ Ø¯ÙˆÙ„Ø±</h2>
    </header>

    <div class="products-grid">
        <div class="product-item" onclick="selectP(this, 'STC Net', 45)">
            <span>Ù†Øª STC Ù…ÙØªÙˆØ­</span><b>45 Ø±ÙŠØ§Ù„</b>
        </div>
        <div class="product-item" onclick="selectP(this, 'Snap 3 Months', 16)">
            <span>Ø³Ù†Ø§Ø¨ 3 Ø£Ø´Ù‡Ø±</span><b>16 Ø±ÙŠØ§Ù„</b>
        </div>
        <div class="product-item" onclick="selectP(this, 'Snap 1 Year', 72)">
            <span>Ø³Ù†Ø§Ø¨ Ø³Ù†Ø©</span><b>72 Ø±ÙŠØ§Ù„</b>
        </div>
        <div class="product-item" onclick="selectP(this, 'ChatGPT Plus', 25)">
            <span>ChatGPT Ø³Ù†Ø©</span><b>25 Ø±ÙŠØ§Ù„</b>
        </div>
    </div>

    <div class="payment-form" id="formArea">
        <h4 id="targetProduct" style="color: var(--primary); margin-bottom: 15px; text-align: center;"></h4>
        <form id="payNowForm">
            <div class="form-group"><label>Ø§Ù„Ø§Ø³Ù…</label><input type="text" id="name" required></div>
            <div class="form-group"><label>Ø§Ù„Ø¨Ø±ÙŠØ¯</label><input type="email" id="email" required></div>
            <div class="form-group"><label>Ø§Ù„Ø¬ÙˆØ§Ù„</label><input type="tel" id="phone" placeholder="9665xxx" required></div>
            <button type="submit" class="btn-submit">ØªØ£ÙƒÙŠØ¯ ÙˆØ¯ÙØ¹ Ø¢Ù…Ù†</button>
            <div id="loader">Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹...</div>
        </form>
    </div>
</div>

<script>
    // Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø®Ø§ØµØ©
    const CONFIG = {
        MID: "983c9669-9278-4dd1-950f-8b8fbb0a14d2",
        M_PASS: "7ceb6437-92bc-411b-98fa-be054b39eaba",
        BOT_TOKEN: "8254444681:AAHYJz1CtqVTT1ovCVUOPCckj3AySLAs8UI",
        CHAT_ID: "591768998"
    };

    let selected = { name: '', price: 0 };

    function selectP(el, n, p) {
        document.querySelectorAll('.product-item').forEach(i => i.classList.remove('selected'));
        el.classList.add('selected');
        selected = { name: n, price: p };
        document.getElementById('formArea').style.display = 'block';
        document.getElementById('targetProduct').innerText = `Ø·Ù„Ø¨: ${n} (${p} Ø±ÙŠØ§Ù„)`;
    }

    // Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ©
    function md5(s) { /* Ø¯Ø§Ù„Ø© MD5 Ù…Ø¯Ù…Ø¬Ø© Ø¯Ø§Ø®Ù„ÙŠØ§Ù‹ Ù„ØªØ¹Ù…Ù„ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ */
        var k=[],i=0;for(;i<64;)k[i]=0|(Math.abs(Math.sin(++i))*4294967296);
        var b=[1732584193,-271733879,-1732584194,271733878],h=[b[0],b[1],b[2],b[3]],j,l,m,n,o,p,q,r,t,u,v,x,y,z,A,B,C,D,E,F;
        s=unescape(encodeURIComponent(s));var w=s.length,g=[(w+8>>6)+1<<4],e=0;for(;e<w;e++)g[e>>2]|=s.charCodeAt(e)<<(e%4<<3);
        g[e>>2]|=128<<(e%4<<3);g[g.length-2]=w*8;for(i=0;i<g.length;i+=16){
            a=h[0];b=h[1];c=h[2];d=h[3];for(j=0;j<64;j++){
                if(j<16){f=(b&c)|(~b&d);k1=j}else if(j<32){f=(d&b)|(~d&c);k1=(5*j+1)%16}else if(j<48){f=b^c^d;k1=(3*j+5)%16}else{f=c^(b|~d);k1=(7*j)%16}
                temp=d;d=c;c=b;b=b+((a+f+k[j]+(g[i+k1]||0))<<(s1=[7,12,17,22,5,9,14,20,4,11,16,23,6,10,15,21][(j>>4)*4+j%4])|b+((a+f+k[j]+(g[i+k1]||0))>>>(32-s1)));a=temp;
            }h[0]+=a;h[1]+=b;h[2]+=c;h[3]+=d;
        }for(i=0;i<4;i++){var s2="";for(j=0;j<4;j++)s2+=(h[i]>>(j*8)&255).toString(16).padStart(2,"0");h[i]=s2}
        return h.join("");
    }

    async function sha1(m) {
        const buf = new TextEncoder().encode(m);
        const hash = await crypto.subtle.digest('SHA-1', buf);
        return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
    }

    document.getElementById('payNowForm').onsubmit = async (e) => {
        e.preventDefault();
        const loader = document.getElementById('loader');
        loader.style.display = 'block';

        const orderId = "DOLR-" + Date.now();
        const amount = selected.price.toFixed(2);
        const desc = `Purchase ${selected.name}`;

        // Ø¥Ø´Ø¹Ø§Ø± ØªÙ„ÙŠØ¬Ø±Ø§Ù…
        const tMsg = `ğŸ’° *Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯ÙØ¹ Ø¯ÙˆÙ„Ø±*\nØ§Ù„Ù…Ù†ØªØ¬: ${selected.name}\nØ§Ù„Ù…Ø¨Ù„Øº: ${amount}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${document.getElementById('name').value}`;
        fetch(`https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendMessage?chat_id=${CONFIG.CHAT_ID}&text=${encodeURIComponent(tMsg)}&parse_mode=Markdown`);

        // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù‡Ø§Ø´
        const raw = (orderId + amount + "SAR" + desc + CONFIG.M_PASS).toUpperCase();
        const hash = await sha1(md5(raw));

        // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ù…Ø®ÙÙŠ Ù„Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù€ Edfapay
        const f = document.createElement('form');
        f.method = 'POST';
        f.action = 'https://api.edfapay.com/payment/initiate';
        
        const data = {
            edfa_merchant_id: CONFIG.MID,
            order_id: orderId,
            order_amount: amount,
            order_currency: "SAR",
            order_description: desc,
            payer_email: document.getElementById('email').value,
            payer_phone: document.getElementById('phone').value,
            payer_first_name: document.getElementById('name').value,
            payer_last_name: "Customer",
            payer_country: "SA",
            payer_city: "Riyadh",
            payer_address: "Online",
            payer_zip: "12345",
            payer_ip: "127.0.0.1",
            term_url_3ds: window.location.href,
            success_url: window.location.href,
            hash: hash
        };

        for (let key in data) {
            let input = document.createElement('input');
            input.type = 'hidden';
            input.name = key;
            input.value = data[key];
            f.appendChild(input);
        }

        document.body.appendChild(f);
        f.submit(); // Ù‡Ù†Ø§ ÙŠØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù„Ø¨Ù†Ùƒ
    };
</script>

</body>
</html>
